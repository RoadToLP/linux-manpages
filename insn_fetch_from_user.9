.TH "insn_fetch_from_user" 9 "insn_fetch_from_user" "May 2021" "Kernel Hacker's Manual" LINUX
.SH NAME
insn_fetch_from_user \- Copy instruction bytes from user-space memory
.SH SYNOPSIS
.B "int" insn_fetch_from_user
.BI "(struct pt_regs *regs "  ","
.BI "unsigned char buf[MAX_INSN_SIZE] "  ");"
.SH ARGUMENTS
.IP "regs" 12
Structure with register values as seen when entering kernel mode
.IP "buf" 12
Array to store the fetched instruction
.SH "DESCRIPTION"
Gets the linear address of the instruction and copies the instruction bytes
to the buf.

Number of instruction bytes copied.

0 if nothing was copied.
.SH "RETURN"
