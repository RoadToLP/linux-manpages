.TH "netlbl_cipsov4_list" 9 "netlbl_cipsov4_list" "May 2021" "Kernel Hacker's Manual" LINUX
.SH NAME
netlbl_cipsov4_list \- Handle a LIST message
.SH SYNOPSIS
.B "int" netlbl_cipsov4_list
.BI "(struct sk_buff *skb "  ","
.BI "struct genl_info *info "  ");"
.SH ARGUMENTS
.IP "skb" 12
the NETLINK buffer
.IP "info" 12
the Generic NETLINK info block
.SH "DESCRIPTION"
Process a user generated LIST message and respond accordingly.  While the
response message generated by the kernel is straightforward, determining
before hand the size of the buffer to allocate is not (we have to generate
the message to know the size).  In order to keep this function sane what we
do is allocate a buffer of NLMSG_GOODSIZE and try to fit the response in
that size, if we fail then we restart with a larger buffer and try again.
We continue in this manner until we hit a limit of failed attempts then we
give up and just send an error message.  Returns zero on success and
negative values on error.
