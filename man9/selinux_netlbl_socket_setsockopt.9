.TH "selinux_netlbl_socket_setsockopt" 9 "selinux_netlbl_socket_setsockopt" "May 2021" "Kernel Hacker's Manual" LINUX
.SH NAME
selinux_netlbl_socket_setsockopt \- Do not allow users to remove a NetLabel
.SH SYNOPSIS
.B "int" selinux_netlbl_socket_setsockopt
.BI "(struct socket *sock "  ","
.BI "int level "  ","
.BI "int optname "  ");"
.SH ARGUMENTS
.IP "sock" 12
the socket
.IP "level" 12
the socket level or protocol
.IP "optname" 12
the socket option name
.SH "DESCRIPTION"
Check the \fBsetsockopt\fP call and if the user is trying to replace the IP
options on a socket and a NetLabel is in place for the socket deny the
access; otherwise allow the access.  Returns zero when the access is
allowed, -EACCES when denied, and other negative values on error.
