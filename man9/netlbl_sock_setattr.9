.TH "netlbl_sock_setattr" 9 "netlbl_sock_setattr" "May 2021" "Kernel Hacker's Manual" LINUX
.SH NAME
netlbl_sock_setattr \- Label a socket using the correct protocol
.SH SYNOPSIS
.B "int" netlbl_sock_setattr
.BI "(struct sock *sk "  ","
.BI "u16 family "  ","
.BI "const struct netlbl_lsm_secattr *secattr "  ");"
.SH ARGUMENTS
.IP "sk" 12
the socket to label
.IP "family" 12
protocol family
.IP "secattr" 12
the security attributes
.SH "DESCRIPTION"
Attach the correct label to the given socket using the security attributes
specified in \fIsecattr\fP.  This function requires exclusive access to \fIsk\fP,
which means it either needs to be in the process of being created or locked.
Returns zero on success, -EDESTADDRREQ if the domain is configured to use
network address selectors (can't blindly label the socket), and negative
values on all other failures.
