.TH "ns_capable_setid" 9 "ns_capable_setid" "May 2021" "Kernel Hacker's Manual" LINUX
.SH NAME
ns_capable_setid \- Determine if the current task has a superior capability in effect, while signalling that this check is being done from within a setid or setgroups syscall.
.SH SYNOPSIS
.B "bool" ns_capable_setid
.BI "(struct user_namespace *ns "  ","
.BI "int cap "  ");"
.SH ARGUMENTS
.IP "ns" 12
The usernamespace we want the capability in
.IP "cap" 12
The capability to be tested for
.SH "DESCRIPTION"
Return true if the current task has the given superior capability currently
available for use, false if not.

This sets PF_SUPERPRIV on the task if the capability is available on the
assumption that it's about to be used.
