.TH "ima_collect_modsig" 9 "ima_collect_modsig" "May 2021" "Kernel Hacker's Manual" LINUX
.SH NAME
ima_collect_modsig \- Calculate the file hash without the appended signature.
.SH SYNOPSIS
.B "void" ima_collect_modsig
.BI "(struct modsig *modsig "  ","
.BI "const void *buf "  ","
.BI "loff_t size "  ");"
.SH ARGUMENTS
.IP "modsig" 12
-- undescribed --
.IP "buf" 12
-- undescribed --
.IP "size" 12
-- undescribed --
.SH "DESCRIPTION"

Since the modsig is part of the file contents, the hash used in its signature
isn't the same one ordinarily calculated by IMA. Therefore PKCS7 code
calculates a separate one for signature verification.
