.TH "calipso_genopt" 9 "calipso_genopt" "May 2021" "Kernel Hacker's Manual" LINUX
.SH NAME
calipso_genopt \- Generate a CALIPSO option
.SH SYNOPSIS
.B "int" calipso_genopt
.BI "(unsigned char *buf "  ","
.BI "u32 start "  ","
.BI "u32 buf_len "  ","
.BI "const struct calipso_doi *doi_def "  ","
.BI "const struct netlbl_lsm_secattr *secattr "  ");"
.SH ARGUMENTS
.IP "buf" 12
the option buffer
.IP "start" 12
offset from which to write
.IP "buf_len" 12
the size of opt_buf
.IP "doi_def" 12
the CALIPSO DOI to use
.IP "secattr" 12
the security attributes
.SH "DESCRIPTION"
Generate a CALIPSO option using the DOI definition and security attributes
passed to the function. This also generates upto three bytes of leading
padding that ensures that the option is 4n + 2 aligned.  It returns the
number of bytes written (including any initial padding).
